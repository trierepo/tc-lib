angular.module("tcLib",["camera","ngDialog","ui.bootstrap"]),angular.module("tcLib").provider("httpService",function(){var s="";try{s=location.href.split("/")[3]}catch(e){s=""}this.setBasePath=function(e){s=e},this.$get=["$http","$q","$parse","msgService",function(n,r,o,a){return{get:i.bind(null,"GET"),del:i.bind(null,"DELETE"),put:e.bind(null,"PUT"),post:e.bind(null,"POST"),upload:function(e,t,n,r,o){return c({url:t=l(t,r,o),method:e,data:n,transformRequest:angular.identity,headers:{"Content-Type":void 0}})}.bind(null,"POST"),getJSON:function(e,t,n){return n&&localStorage.getItem(n)?r.when(null).then(function(){var e=localStorage.getItem(n);return JSON.parse(e)}):i(e,t).then(function(e){return localStorage.setItem(n,e.json),e})}.bind(null,"GET")};function i(e,t,n,r){return c({method:e,url:t=l(t,n,r)})}function e(e,t,n,r,o){return c({method:e,url:t=l(t,r,o),data:n})}function l(e,t,n){return t&&(e+="?"+toURLParams(t,n)),"/"+s+"/"+e}function c(e){var t=r.defer();return n(e).success(function(e){e.isSuccess?t.resolve(e.response):(t.reject(e),a.showMsg({msg:o("response")(e)||e,type:"danger",title:"Error"}))}).error(function(e){t.reject(e),a.showMsg({msg:e,type:"danger",title:"Error"})}),t.promise}}]}),angular.module("tcLib").directive("bindHtmlCompile",["$compile",function(r){return{restrict:"A",link:function(t,n,e){t.$watch(function(){return t.$eval(e.bindHtmlCompile)},function(e){n.html(e),r(n.contents())(t)})}}}]),angular.module("tcLib").directive("tcCamera",["ngDialog",function(o){return{restrict:"A",require:"ngModel",scope:{onCapture:"&",confirmText:"@"},link:function(t,e,n,r){angular.element(e).bind("click",function(){t.capturePhoto()}),t.autoClose=!t.confirmText,t.setModel=function(e){t.tempModel=e},t.setConfirmed=function(e){t.confirmed=e},t.capturePhoto=function(){o.open({template:"src/camera/camera-modal.html",className:"ngdialog-theme-default ngdialog-lg",controller:"cameraModelCtrl",scope:t}).closePromise.then(function(){"function"==typeof t.onCapture&&(t.confirmed&&r.$setViewValue(t.tempModel),t.onCapture({$snap:t.tempModel}))})}}}}]),angular.module("tcLib").controller("cameraModelCtrl",["$scope","ngDialog",function(t,e){t.onCamCapture=function(e){t.setModel(e),t.autoClose&&t.confirm()},t.confirm=function(){t.setConfirmed(!0)},t.cancel=function(){t.setConfirmed(!1)}}]),angular.module("tcLib").directive("clickAndDisable",[function(){return{restrict:"A",scope:{clickAndDisable:"&"},link:function(e,t,n){t.bind("click",function(){e.clickAndDisable=e.clickAndDisable||$timeout(angular.noop,5e3),t.prop("disabled",!0),e.clickAndDisable().finally(function(){t.prop("disabled",!1)})})}}}]),angular.module("tcLib").directive("tcDatePicker",["$parse",function(a){return{restrict:"E",scope:{name:"@",options:"=?",placeholder:"@",model:"=ngModel"},templateUrl:"src/date-picker/date-picker.html",link:function(o,e,t){function n(e){var t=e.date;if("day"===e.mode)for(var n=new Date(t).setHours(0,0,0,0),r=0;r<(a("events.length")(o)||0);r++){if(n===new Date($scope.events[r].date).setHours(0,0,0,0))return $scope.events[r].status}return""}o.calendarPanel={opened:!1},o.openCalendar=function(){o.calendarPanel.opened=!0},o.$watch("options",function(e,t){o.dateOptions={formatYear:"yy",showWeeks:!1,customClass:n,minDate:a("options.minDate")(o)||null,maxDate:a("options.maxDate")(o)||new Date(2040,12,31),startingDay:1}})}}}]),angular.module("tcLib").directive("tcFileInput",[function(){return{restrict:"AE",require:"ngModel",scope:{ngModel:"="},link:function(e,n,r,o){n.on("change",function(e){var t=n[0].files;o.$setViewValue(null),r.multiple?o.$setViewValue(t.length?t:null):o.$setViewValue(t[0])})}}}]),angular.module("tcLib").directive("messages",function(){function e(r){function o(e){r.globalMsgs.splice(e,1)}r.globalMsgs=[],r.remove=o,r.$on("MESSAGE_SHOW",function(e,t){r.globalMsgs.splice(0,0,t)}),r.$on("MESSAGE_HIDE",function(e,t){var n=r.globalMsgs.indexOf(t);-1!=n&&o(n)}),r.$on("MESSAGE_HIDE_ALL",function(e){r.globalMsgs=[]})}return e.$inject=["$scope"],{restrict:"E",controller:e,templateUrl:"src/messages/message.html"}}).service("msgService",["$timeout","$rootScope","$parse",function(t,n,r){return{showMsg:function(e){n.$broadcast("MESSAGE_SHOW",e),document.querySelector(".message-wrapper").scrollTop=0,"danger"!==r("type")(e)&&t(function(){n.$broadcast("MESSAGE_HIDE",e)},r("time")(e)||2e3)},hideAll:function(){n.$broadCast("MESSAGE_HIDE_ALL")}}}]),angular.module("tcLib").filter("tcCamelCase",function(){return function(e){return(e=e||"").replace(/\w\S*/g,function(e){for(var t=e.charAt(0).toUpperCase()+e.substr(1).toLowerCase(),n=0;n<t.length;n++)"."===t[n]&&(t=t.replace(t.charAt(n+1),function(e){return e.toUpperCase()}));return t})}}),angular.module("tcLib").run(["$templateCache",function(e){e.put("src/camera/camera-modal.html",'<div class="camera-wrapper row"><ng-camera capture-message="Done!" class="grid-md-5" countdown="3" output-height="240" output-width="320" viewer-height="315" viewer-width="420" image-format="jpeg" jpeg-quality="100" action-message="Take picture" snapshot="model" overlay-url="./assets/images/overlay.png" shutter-url="./assets/sounds/camera-click.mp3" on-capture="onCamCapture($snap)"></ng-camera><div class="preview-wrapper grid-md-5" ng-if="model"><img ng-src="{{model}}" alt="Click capture to see preview"><div class="grid-md-4 ngdialog-buttons"><button class="btn btn-md btn-green" ng-if="confirmText && model" ng-click="confirm();closeThisDialog(0)">{{confirmText}}</button> <button class="btn btn-md btn-grey" ng-if="confirmText" ng-click="cancel();closeThisDialog(0);">Cancel</button></div></div></div>'),e.put("src/date-picker/date-picker.html",'<input placeholder="{{placeholder}}" class="form-field grid-md-12" ng-attr-name="{{name}}" ng-model="model" uib-datepicker-popup is-open="calendarPanel.opened" datepicker-options="dateOptions" ng-required="{{required}}" close-text="Close"> <span class="form-field-icon"><button type="button" class="btn btn-sm btn-sky-blue" ng-click="openCalendar()"><i class="fa fa-calendar"></i></button></span>'),e.put("src/messages/message.html",'<div class="message-wrapper"><div ng-repeat="msg in globalMsgs" class="alert alert-{{msg.type}}"><i class="fa fa-times pull-right" ng-click="remove($index)"></i> <strong>{{msg.title}}:</strong> <span>{{msg.msg}}</span></div></div>')}]),angular.module("tcLib").directive("whenScrolled",function(){return{restrict:"A",scope:{scrollerApi:"=?",whenScrolled:"&"},link:function(e,t,n){var r=0;raw=t[0],t.bind("scroll",function(){r<raw.scrollTop&&raw.scrollTop+raw.offsetHeight>=raw.scrollHeight&&(e.whenScrolled(),r=raw.scrollTop)}),e.scrollerApi={resetScroll:function(){r=0,raw.scrollTop=0}}}}});